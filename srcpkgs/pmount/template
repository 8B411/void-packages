# Template file for 'pmount'
pkgname=pmount
version=0.9.23
revision=9
build_style=gnu-configure
hostmakedepends="intltool"
makedepends="libblkid-devel"
short_desc="Permits normal users to mount removable devices"
maintainer="Enno Boland <gottox@voidlinux.org>"
license="GPL-3.0-only"
homepage="https://salsa.debian.org/debian/pmount"
distfiles="https://salsa.debian.org/debian/pmount/-/archive/debian/${version}-${revision}/pmount-debian-${version}-${revision}.tar.bz2"
checksum=3480012b44479bc8ea3d63e23e5b89f8decf2e8233ddee232a2fc9ccb95eb3bf
conf_files="/etc/pmount.allow"
make_check=no # Testing always fails

pre_patch() {
	# Remove Debian-specific patch
	vsed -i -e '/01-man-plugdev/d' debian/patches/series
	(cd debian/patches; xargs cat < series) | patch -Np1
}

post_patch() {
	vsed -i -e 's/DATADIRNAME=lib/DATADIRNAME=share/' configure
	vsed -i -e 's/-o root -g root //' src/Makefile.in
}
